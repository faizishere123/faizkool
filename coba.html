<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SC Telegram - Login</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Orbitron', sans-serif;
      background: #0a0a0a;
      color: white;
      min-height: 100vh;
    }
    .container {
      max-width: 460px;
      margin: auto;
      padding: 25px;
      position: relative;
      text-align: center;
    }
    .logo-img {
      width: 110px;
      border-radius: 50%;
      display: block;
      margin: 30px auto 10px;
      box-shadow: 0 0 15px #00f0ff;
    }
    .top-right {
      position: absolute;
      top: 20px;
      right: 20px;
    }
    .info-box {
      background: rgba(0, 255, 255, 0.1);
      padding: 10px;
      border-radius: 10px;
      text-align: left;
      font-size: 14px;
      margin-top: 10px;
      border: 1px solid #00f0ff;
    }
    .panel {
      background: #111;
      padding: 30px;
      border-radius: 20px;
      margin-top: 20px;
      box-shadow: 0 0 20px #00f0ff44;
    }
    h2, h3 {
      margin: 10px 0;
      font-size: 24px;
      letter-spacing: 1px;
    }
    input, button {
      width: 100%;
      padding: 14px;
      margin-top: 15px;
      border: none;
      border-radius: 10px;
      font-family: 'Orbitron', sans-serif;
      font-size: 15px;
    }
    input {
      background: #222;
      color: white;
      outline: none;
    }
    button {
      background: linear-gradient(to right, #00f0ff, #006eff);
      color: white;
      font-weight: bold;
      transition: 0.3s;
    }
    button:hover {
      opacity: 0.9;
    }
    .hidden { display: none; }
    .status {
      margin-top: 20px;
      padding: 15px;
      background: #0f0f0f;
      border-left: 4px solid #00f0ff;
      border-radius: 8px;
      font-size: 14px;
      text-align: left;
    }
    .footer {
      text-align: center;
      margin-top: 35px;
      font-size: 12px;
      color: #aaa;
    }
  </style>
</head>
<body>
  <div class="container">
    <img src="https://files.catbox.moe/xq0il2.jpg" class="logo-img">
    <div class="top-right">
      <button onclick="toggleInfo()">⋮</button>
      <div id="accountInfo" class="info-box hidden"></div>
    </div>

    <!-- Login Box -->
    <div class="panel" id="loginBox">
      <h2>Login SC Telegram</h2>
      <input type="text" id="username" placeholder="Username">
      <input type="password" id="password" placeholder="Password">
      <button onclick="login()">MASUK</button>
    </div>

    <!-- Dashboard Box -->
    <div class="panel hidden" id="dashboardBox">
      <h3>Tambah Bot Telegram</h3>
      <input type="text" id="token" placeholder="Token Bot Telegram">
      <input type="text" id="targetUsername" placeholder="Username Bot">
      <input type="password" id="targetPassword" placeholder="Password Bot">
      <button onclick="addToDatabase()">TAMBAHKAN</button>
      <div class="status" id="status">Status: Menunggu input...</div>
    </div>

    <div class="footer">@KenXiterr</div>
  </div>

  <script>
    const GITHUB_TOKEN = "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";
    const GITHUB_OWNER = "faizzishere123";
    const GITHUB_REPO = "faizz-services";
    const FILE_PATH = "tokens.json";

    const ROLE_FILES = {
      owner: "owner.json",
      moderator: "moderator.json",
      pt: "pt.json",
      reseller: "res.json",
      tk: "tk.json"
    };

    let currentUser = null;
    let currentRole = null;

    async function login() {
      const user = document.getElementById("username").value.trim();
      const pass = document.getElementById("password").value.trim();
      if (!user || !pass) return alert("Harap isi semua input.");

      for (let role in ROLE_FILES) {
        const url = `https://raw.githubusercontent.com/${GITHUB_OWNER}/${GITHUB_REPO}/main/${ROLE_FILES[role]}`;
        try {
          const res = await fetch(url);
          const data = await res.json();
          const match = data.find(u => u.username === user && u.password === pass);
          if (match) {
            currentUser = match;
            currentRole = role;
            showDashboard(match, role);
            return;
          }
        } catch (err) {
          console.error("Gagal akses:", role);
        }
      }
      alert("Login gagal: Akun tidak ditemukan.");
    }

    function showDashboard(user, role) {
      document.getElementById("loginBox").classList.add("hidden");
      document.getElementById("dashboardBox").classList.remove("hidden");
      document.getElementById("accountInfo").innerHTML = `
        <strong>Username:</strong> ${user.username}<br>
        <strong>Password:</strong> ${user.password}<br>
        <strong>Expired:</strong> ${user.expired}<br>
        <strong>Role:</strong> ${role}
      `;
    }

    function toggleInfo() {
      document.getElementById("accountInfo").classList.toggle("hidden");
    }

    async function addToDatabase() {
      const token = document.getElementById("token").value.trim();
      const username = document.getElementById("targetUsername").value.trim();
      const password = document.getElementById("targetPassword").value.trim();
      const status = document.getElementById("status");

      if (!token || !username || !password) {
        status.innerText = "❌ Semua input wajib diisi!";
        return;
      }

      try {
        const apiUrl = `https://api.github.com/repos/${GITHUB_OWNER}/${GITHUB_REPO}/contents/${FILE_PATH}`;
        const getRes = await fetch(apiUrl, {
          headers: { Authorization: `Bearer ${GITHUB_TOKEN}` }
        });
        const jsonData = await getRes.json();
        const content = atob(jsonData.content);
        let data = JSON.parse(content);
        data.push({ token, username, password });

        const updatedContent = btoa(JSON.stringify(data, null, 2));
        const updateRes = await fetch(apiUrl, {
          method: "PUT",
          headers: {
            Authorization: `Bearer ${GITHUB_TOKEN}`,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            message: "Tambah bot Telegram via dashboard",
            content: updatedContent,
            sha: jsonData.sha
          })
        });

        if (updateRes.ok) {
          status.innerText = "✅ Bot berhasil ditambahkan.";
        } else {
          status.innerText = "❌ Gagal menyimpan ke GitHub.";
        }
      } catch (err) {
        status.innerText = "❌ Error koneksi atau token salah.";
      }
    }
  </script>
</body>
</html>
